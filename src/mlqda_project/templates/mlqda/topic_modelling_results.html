<!DOCTYPE html>
{% extends 'mlqda/base.html' %}
{% load static %}

{% block title_block%}
	Contact
{% endblock %}

{% block body_block %}
	<div class="flex-container" id="maintext">
		<h1>Topic Modelling Results</h1>
		<p>The script identified {{ total_topics }} topics in your files.</p>
		
		<p>Ideally these words describe distinct topics in your documents. You will need to deduct
		what these topics are based on the top words. Next to the words, you can also see their contribution
		as a percentage. Within the results, you can see highlighted sentences for each topic. Every
		highlighted pdf shows you the sentences connected to that topic. This way, you can see which sentences
		are connected to the topics.</p>

		<p>Next to the sentences, you can also see the sentiment scores. These are 'compound' sentiment scores,
		as they are based on negative, neutral and positive sentiment scores. They range from -1 to 1. You can
		also find aggregated sentiment scores for each of your document and for your entire corpora.</p>
		
		<p>If you want to know more about the process or how to interpret your result you check out
		 the FAQ or the About section.</p>
		</br></br>
		<button type="submit" name="submit" class="general_button" onclick="window.open('{% url 'mlqda:download-files' zip_name %}')"> 
			<p class="button_text"> Download results </p>
		</button>
		</br></br>
	</div>

	<div class="topic_results">
		<h1>Topic Word Contribution</h1>
		{% for topic, tuple in topics.items %}
			<h2>Topic {{topic}}</h2>
			<div class="topic_grid">
				{% for contrib, word in tuple %}		
					<p>{{word}}: {{contrib}}</p>
				{% endfor %}
			</div>
		{% endfor %}
	</div>		

	<script src="{% static 'js/jquery-3.3.1.min.js' %}" crossorigin="anonymous"></script>
	<script>
		var this_collector_id = {{ collector_id }};
		var del_msg = 'deleted files: '
		var final_msg = del_msg.concat(this_collector_id)
		window.onbeforeunload = function() { return confirmExit(); }
		window.onunload = function() { return deleteF(); }


		function confirmExit() {
			return "Leaving this page will delete all your data!";
		}
		
		function deleteF(){
			$.ajax({
				method:'GET',
				url:'/mlqda/delete-files/',
				data:{collector_id:this_collector_id}
			}).done(function() {
				alert(final_msg)
			});
		}
	</script>
{% endblock %}
